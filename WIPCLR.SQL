EXEC sp_configure 'clr strict security', 0;
RECONFIGURE;
GO
sp_configure 'clr enabled', 1;              /*1:enable, 0:disable*/
GO 
RECONFIGURE;

USE [master]
GO
CREATE DATABASE [clr]; 
GO
ALTER AUTHORIZATION ON DATABASE::[clr] TO [sa]; 
GO
ALTER DATABASE [clr] SET TRUSTWORTHY ON; 
GO
USE [clr]; 
GO
CREATE ASSEMBLY [WIPCLR] FROM ',Yourpath>\WIPCLR.dll'
WITH PERMISSION_SET = EXTERNAL_ACCESS
GO

CREATE FUNCTION dbo.WIPCLR()
RETURNS NVARCHAR(255)
AS
EXTERNAL NAME WIPCLR.[WIPCLR.CLRGETIP].[IP];
GO

Select dbo.WIPCLR()
